{% extends 'base.html' %}

{% block title %}Upload Data{% endblock %}

{% block head %}
{% endblock %}

{% block content %}
<h1>Upload Data</h1>
<form id="form">
    <input type="file" id="data" accept="application/json" required>
    <br />
    <input type="submit">
</form>
<p id="message" style="display: none;">You shouldn't see this.</p>

<script>
    document.getElementById("form").addEventListener('submit', async function(event) {
    event.preventDefault();
    submitData(
        document.getElementById("data").files[0],
    );
    });

    function submitData(data){
        fetch("{{ url_for('uploadJSON') }}", {
        method: "POST",
        body: data,
        headers: {
            "Content-type": data.type
        }
        }).then(response =>{
            message = document.getElementById("message");
            if (response.ok){
                message.innerHTML = "Submitted data!";
                message.style = "display:inline;"
                document.getElementById("form").reset();
            } else if (response.status == 404){
                message.innerHTML = "Error, match not found."
                message.style = "display:inline; color:red;"
            } else{
                message.innerHTML = "Error, unable to submit."
                message.style = "display:inline; color:red;"
            }
        });
    }
</script>
{% endblock %}